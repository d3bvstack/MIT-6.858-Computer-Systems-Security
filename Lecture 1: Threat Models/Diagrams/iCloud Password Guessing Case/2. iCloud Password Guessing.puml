@startuml
actor Attacker

participant "iCloud Web\nLogin UI" as WebLogin
participant "Find My iPhone\nAPI" as FMI
participant "Central Auth\nService" as Auth
database "User\nAccount" as Account

== Normal login path (rate-limited) ==
Attacker -> WebLogin: Submit password guess
WebLogin -> Auth: Verify credentials
Auth -> Account: Check username + password
Account --> Auth: Success/Failure
Auth --> WebLogin: Result

loop Up to N failures
    Attacker -> WebLogin: More guesses
    WebLogin -> Auth: Verify credentials
    Auth -> Account: Check password
    Account --> Auth: Failure
    Auth --> WebLogin: Failure
end

WebLogin -> Auth: Enforce lockout / slow-down
note right: This interface has rate limiting\nagainst online guessing

== Vulnerable path (no rate limiting) ==
loop Many millions of guesses
    Attacker -> FMI: API request with password guess
    FMI -> Auth: Verify credentials
    Auth -> Account: Check password
    Account --> Auth: Success/Failure
    Auth --> FMI: Result
end

note right of FMI
  Bug: FMI interface forgot\nrate limiting / lockout
  -> Allows online brute-force
  -> Weak passwords quickly guessed
end note
