                                                                                                                           ,.-^^-._
                        ┌─┐                                                                                               |-.____.-|
                        ║"│                                                                                               |        |
                        └┬┘                                                                                               |        |
                        ┌┼┐               ┌──────────┐           ┌──────────────┐           ┌────────────┐                |        |
                         │                │iCloud Web│           │Find My iPhone│           │Central Auth│                '-.____.-'
                        ┌┴┐               │Login UI  │           │API           │           │Service     │                 User
                     Attacker             └─────┬────┘           └───────┬──────┘           └──────┬─────┘                 Account
                         │                      │                        │                         │                          │
                         │                      │        ╔═══════════════╧══════════════════╗      │                          │
═════════════════════════╪══════════════════════╪════════╣ Normal login path (rate-limited) ╠══════╪══════════════════════════╪════════════════════════
                         │                      │        ╚═══════════════╤══════════════════╝      │                          │
                         │                      │                        │                         │                          │
                         │Submit password guess │                        │                         │                          │
                         │─────────────────────>│                        │                         │                          │
                         │                      │                        │                         │                          │
                         │                      │               Verify credentials                 │                          │
                         │                      │─────────────────────────────────────────────────>│                          │
                         │                      │                        │                         │                          │
                         │                      │                        │                         │Check username + password │
                         │                      │                        │                         │─────────────────────────>│
                         │                      │                        │                         │                          │
                         │                      │                        │                         │     Success/Failure      │
                         │                      │                        │                         │<─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│
                         │                      │                        │                         │                          │
                         │                      │                     Result                       │                          │
                         │                      │<─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│                          │
                         │                      │                        │                         │                          │
                         │                      │                        │                         │                          │
          ╔═══════╤══════╪══════════════════════╪════════════════════════╪═════════════════════════╪══════════════════════════╪═════════════╗
          ║ LOOP  │  Up to N failures           │                        │                         │                          │             ║
          ╟───────┘      │                      │                        │                         │                          │             ║
          ║              │    More guesses      │                        │                         │                          │             ║
          ║              │─────────────────────>│                        │                         │                          │             ║
          ║              │                      │                        │                         │                          │             ║
          ║              │                      │               Verify credentials                 │                          │             ║
          ║              │                      │─────────────────────────────────────────────────>│                          │             ║
          ║              │                      │                        │                         │                          │             ║
          ║              │                      │                        │                         │     Check password       │             ║
          ║              │                      │                        │                         │─────────────────────────>│             ║
          ║              │                      │                        │                         │                          │             ║
          ║              │                      │                        │                         │         Failure          │             ║
          ║              │                      │                        │                         │<─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│             ║
          ║              │                      │                        │                         │                          │             ║
          ║              │                      │                     Failure                      │                          │             ║
          ║              │                      │<─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│                          │             ║
          ╚══════════════╪══════════════════════╪════════════════════════╪═════════════════════════╪══════════════════════════╪═════════════╝
                         │                      │                        │                         │                          │
                         │                      │           Enforce lockout / slow-down            │ ╔════════════════════════╧═════════╗
                         │                      │─────────────────────────────────────────────────>│ ║This interface has rate limiting ░║
                         │                      │                        │                         │ ║against online guessing           ║
                         │                      │                        │                         │ ╚════════════════════════╤═════════╝
                         │                      │                        │                         │                          │
                         │                      │       ╔════════════════╧═══════════════════╗     │                          │
═════════════════════════╪══════════════════════╪═══════╣ Vulnerable path (no rate limiting) ╠═════╪══════════════════════════╪════════════════════════
                         │                      │       ╚════════════════╤═══════════════════╝     │                          │
                         │                      │                        │                         │                          │
                         │                      │                        │                         │                          │
          ╔═══════╤══════╪══════════════════════╪════════════════════════╪═════════════════════════╪══════════════════════════╪═════════════╗
          ║ LOOP  │  Many millions of guesses   │                        │                         │                          │             ║
          ╟───────┘      │                      │                        │                         │                          │             ║
          ║              │       API request with password guess         │                         │                          │             ║
          ║              │──────────────────────────────────────────────>│                         │                          │             ║
          ║              │                      │                        │                         │                          │             ║
          ║              │                      │                        │   Verify credentials    │                          │             ║
          ║              │                      │                        │────────────────────────>│                          │             ║
          ║              │                      │                        │                         │                          │             ║
          ║              │                      │                        │                         │     Check password       │             ║
          ║              │                      │                        │                         │─────────────────────────>│             ║
          ║              │                      │                        │                         │                          │             ║
          ║              │                      │                        │                         │     Success/Failure      │             ║
          ║              │                      │                        │                         │<─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│             ║
          ║              │                      │                        │                         │                          │             ║
          ║              │                      │                        │         Result          │                          │             ║
          ║              │                      │                        │<─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ │                          │             ║
          ╚══════════════╪══════════════════════╪════════════════════════╪═════════════════════════╪══════════════════════════╪═════════════╝
                         │                      │                        │                         │                          │
                         │                      │                        │ ╔═══════════════════════╧══════════════════════════╧═╗
                         │                      │                        │ ║Bug: FMI interface forgot\nrate limiting / lockout ░║
                         │                      │                        │ ║-> Allows online brute-force                        ║
                         │                      │                        │ ║-> Weak passwords quickly guessed                   ║
                     Attacker             ┌─────┴────┐           ┌───────┴─╚════════════════════════════════════════════════════╝
                        ┌─┐               │iCloud Web│           │Find My iPhone│           │Central Auth│                 ,.-^^-._
                        ║"│               │Login UI  │           │API           │           │Service     │                |-.____.-|
                        └┬┘               └──────────┘           └──────────────┘           └────────────┘                |        |
                        ┌┼┐                                                                                               |        |
                         │                                                                                                |        |
                        ┌┴┐                                                                                               '-.____.-'

